<div class="hero-section" *ngIf="!query && featuredMovie">
  <div class="hero-bg">
    <img [src]="featuredMovie.poster_path | posterUrl: 'original'" alt="Background">
  </div>
  <div class="hero-overlay"></div>
  <div class="hero-content">
    <h1 class="hero-title">{{ featuredMovie.title }}</h1>
    <div class="hero-meta">
      <span class="match-score">{{ (featuredMovie.vote_average * 10) | number:'1.0-0' }}% Match</span>
      <span>{{ featuredMovie.release_date | date:'yyyy' }}</span>
      <div class="genre-pills">
        <span class="genre-pill">Featured</span>
        <span class="genre-pill">Trending</span>
      </div>
    </div>
    <p class="hero-desc">{{ featuredMovie.overview }}</p>
    <div class="hero-actions">
      <button class="btn-primary" (click)="playMovie(featuredMovie)">
        <i class="fas fa-play"></i> play now
      </button>
      <button class="btn-secondary" (click)="addToFavorites(featuredMovie)">
        <i class="fas fa-heart" *ngIf="isFeaturedFavorite"></i>
        <i class="far fa-heart" *ngIf="!isFeaturedFavorite"></i>
      </button>
    </div>
  </div>
</div>

<!-- 3 Netflix-Style Auto-Scrolling Sliders -->
<div class="content-rows" *ngIf="!query">
  <!-- Slider 1: Trending Movies -->
  <div class="slider-row" *ngIf="recommendedMovies.length">
    <div class="row-header-with-nav">
      <h2 class="row-title">trending movies</h2>
      <div class="slider-nav-arrows">
        <button class="nav-arrow prev" (click)="scrollSliderLeft($event)">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="nav-arrow next" (click)="scrollSliderRight($event)">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
    <div class="slider-container">
      <div class="slider-track auto-scroll" (mouseenter)="pauseScroll($event)" (mouseleave)="resumeScroll($event)">
        <div class="movie-card" *ngFor="let movie of recommendedMovies.concat(recommendedMovies)" (click)="watchMedia(movie)">
          <div class="poster-container">
            <img [src]="movie.backdrop_path | backdropUrl" [alt]="movie.title" [style.object-fit]="movie.backdrop_path ? 'cover' : 'contain'">
            <div class="card-overlay">
              <div class="play-btn-small"><i class="fas fa-play"></i></div>
            </div>
          </div>
          <div class="card-info">
            <div class="card-title">{{ movie.title }}</div>
            <div class="card-meta">
              <span>{{ movie.release_date | date:'yyyy' }}</span>
              <span><i class="fas fa-star text-accent"></i> {{ movie.vote_average | number:'1.1-1' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Slider 2: Popular TV Shows -->
  <div class="slider-row" *ngIf="recommendedShows.length">
    <div class="row-header-with-nav">
      <h2 class="row-title">popular tv shows</h2>
      <div class="slider-nav-arrows">
        <button class="nav-arrow prev" (click)="scrollSliderLeft($event)">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="nav-arrow next" (click)="scrollSliderRight($event)">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
    <div class="slider-container">
      <div class="slider-track auto-scroll-fast" (mouseenter)="pauseScroll($event)" (mouseleave)="resumeScroll($event)">
        <div class="movie-card" *ngFor="let show of recommendedShows.concat(recommendedShows)" (click)="watchMedia(show)">
          <div class="poster-container">
            <img [src]="show.backdrop_path | backdropUrl" [alt]="show.title" [style.object-fit]="show.backdrop_path ? 'cover' : 'contain'">
            <div class="card-overlay">
              <div class="play-btn-small"><i class="fas fa-play"></i></div>
            </div>
          </div>
          <div class="card-info">
            <div class="card-title">{{ getTitle(show) }}</div>
            <div class="card-meta">
              <span>{{ getReleaseDate(show) | date:'yyyy' }}</span>
              <span><i class="fas fa-star text-accent"></i> {{ show.vote_average | number:'1.1-1' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Slider 3: Top Anime -->
  <div class="slider-row" *ngIf="recommendedAnime.length">
    <div class="row-header-with-nav">
      <h2 class="row-title">top anime</h2>
      <div class="slider-nav-arrows">
        <button class="nav-arrow prev" (click)="scrollSliderLeft($event)">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="nav-arrow next" (click)="scrollSliderRight($event)">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
    <div class="slider-container">
      <div class="slider-track auto-scroll-slow" (mouseenter)="pauseScroll($event)" (mouseleave)="resumeScroll($event)">
        <div class="movie-card" *ngFor="let anime of recommendedAnime.concat(recommendedAnime)" (click)="watchMedia(anime)">
          <div class="poster-container">
            <img [src]="anime.backdrop_path | backdropUrl" [alt]="anime.title" [style.object-fit]="anime.backdrop_path ? 'cover' : 'contain'">
            <div class="card-overlay">
              <div class="play-btn-small"><i class="fas fa-play"></i></div>
            </div>
          </div>
          <div class="card-info">
            <div class="card-title">{{ getTitle(anime) }}</div>
            <div class="card-meta">
              <span>{{ getReleaseDate(anime) | date:'yyyy' }}</span>
              <span><i class="fas fa-star text-accent"></i> {{ anime.vote_average | number:'1.1-1' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Search Results -->
<div class="search-results-page" *ngIf="query">
  <div class="results-header">
    <div class="header-content">
      <div class="header-icon">
        <i class="fas fa-search"></i>
      </div>
      <div class="header-text">
        <h1 class="results-title">search results for "{{ query }}"</h1>
        <p class="results-count">
          <span class="count-number">{{ results.length }}</span> 
          {{ results.length === 1 ? 'result' : 'results' }} found
        </p>
      </div>
    </div>
  </div>
  
  <div class="results-grid" *ngIf="results.length">
    <div class="result-card" *ngFor="let movie of results" (click)="watchMedia(movie)">
      <div class="result-poster">
        <img [src]="movie.poster_path | posterUrl" [alt]="movie.title">
        <div class="poster-gradient"></div>
        <div class="result-content">
          <h3 class="result-title">{{ getTitle(movie) }}</h3>
          <div class="result-meta">
            <span>{{ getReleaseDate(movie) | date:'yyyy' }}</span>
            <span>â€¢</span>
            <span><i class="fas fa-star"></i> {{ movie.vote_average | number:'1.1-1' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div *ngIf="results.length === 0 && !loading" class="empty-results">
    <div class="empty-icon">
      <i class="fas fa-search"></i>
    </div>
    <h3>No results found</h3>
    <p>Try searching with different keywords</p>
    <button class="browse-btn" (click)="query = ''; search()">
      <i class="fas fa-home"></i>
      Back to Home
    </button>
  </div>
</div>

<!-- Add to List Modal -->
<div *ngIf="showListPrompt" class="modal-overlay" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;display:flex;align-items:center;justify-content:center;">
  <div class="modal-content" style="background:var(--bg-card-secondary);padding:2rem;border-radius:var(--radius-lg);width:90%;max-width:400px;border:1px solid var(--border-subtle);">
    <h3 style="margin-bottom:1rem;">Add to List</h3>
    
    <div *ngIf="userLists.length" style="margin-bottom:1rem; display:flex; flex-direction:column; gap:0.5rem;">
      <label *ngFor="let list of userLists" style="display:flex; align-items:center; gap:0.5rem; cursor:pointer;">
        <input type="checkbox" [value]="list.id" [(ngModel)]="selectedListIds">
        {{ list.title }}
      </label>
    </div>

    <div style="margin-bottom:1rem;">
      <input [(ngModel)]="newListTitle" placeholder="New List Title" style="width:100%; padding:0.8rem; background:rgba(255,255,255,0.1); border:none; border-radius:var(--radius-sm); color:white;">
    </div>

    <div style="display:flex; gap:1rem;">
      <button class="btn-primary" (click)="userLists.length && !newListTitle ? confirmAddToList() : addNewListInline()">
        {{ newListTitle ? 'Create & Add' : 'Add to Selected' }}
      </button>
      <button class="btn-secondary" style="border-radius:8px; width:auto; padding:0 1rem;" (click)="cancelAddToList()">Cancel</button>
    </div>
  </div>
</div>
